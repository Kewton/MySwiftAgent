version: 0.5
nodes:
  # ãƒ†ã‚¹ãƒˆç”¨ã®å…¥åŠ›ãƒ‡ãƒ¼ã‚¿
  source: {}

  test_content:
    value: |-
        # GraphAI ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ

        ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€expertAgentã®æ–°æ©Ÿèƒ½ã§ã‚ã‚‹ã€Œã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‹ã‚‰ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆâ†’Google Driveã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã€æ©Ÿèƒ½ã®ãƒ†ã‚¹ãƒˆã§ã™ã€‚

        ## ãƒ†ã‚¹ãƒˆæ—¥æ™‚
        2025-10-15

        ## ãƒ†ã‚¹ãƒˆå†…å®¹
        - graphAiServerãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‹ã‚‰expertAgentã®MCPãƒ„ãƒ¼ãƒ«ã‚’å‘¼ã³å‡ºã—
        - ãƒ¡ãƒ¢ãƒªä¸Šã®ãƒ†ã‚­ã‚¹ãƒˆã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‹ã‚‰ç›´æ¥Google Driveã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
        - ã‚µãƒ–ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¸ã®è‡ªå‹•é…ç½®

        ## æœŸå¾…çµæœ
        - ãƒ•ã‚¡ã‚¤ãƒ«ãŒæ­£å¸¸ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã‚‹ã“ã¨
        - Google Driveã®ãƒªãƒ³ã‚¯URLãŒè¿”å´ã•ã‚Œã‚‹ã“ã¨
        - ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ãŒè‡ªå‹•å‰Šé™¤ã•ã‚Œã‚‹ã“ã¨

        âœ… ã“ã®ãƒ†ã‚¹ãƒˆãŒæˆåŠŸã™ã‚Œã°ã€graphAiServerãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å†…ã§LLMãŒç”Ÿæˆã—ãŸã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’
        ã€€ç›´æ¥Google Driveã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã§ãã‚‹ã“ã¨ãŒç¢ºèªã§ãã¾ã™ï¼

  # expertAgentã®actionã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’ä½¿ç”¨ã—ã¦ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
  upload_prompt:
    agent: stringTemplateAgent
    inputs:
      user_input: :source
      content: :test_content
    console:
      before: upload_prompt start
    params:
      template: |-
        ä»¥ä¸‹ã®ãƒ†ã‚­ã‚¹ãƒˆã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’Google Driveã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ãã ã•ã„ã€‚

        ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›: ${user_input}

        - ãƒ•ã‚¡ã‚¤ãƒ«å: graphai_test_upload.txt
        - ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹: /tmp/graphai_test_upload.txt
        - ã‚µãƒ–ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª: graphai_tests/content_upload
        - ã‚³ãƒ³ãƒ†ãƒ³ãƒ„:
        ---
        ${content}
        ---

        ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å¾Œã€ãƒªãƒ³ã‚¯URLã‚’è¿”å´ã—ã¦ãã ã•ã„ã€‚

        # RESPONSE FORMAT (JSON):
        {
          "status": "success",
          "file_name": "...",
          "web_view_link": "...",
          "folder_path": "..."
        }

        /no_think

  # expertAgentã®actionã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«å‡¦ç†ã‚’ä¾é ¼
  action:
    agent: fetchAgent
    console:
      before: action start (uploading content to Google Drive)
      after: true
    inputs:
      url: http://127.0.0.1:8104/aiagent-api/v1/aiagent/utility/action
      method: POST
      body:
        user_input: :upload_prompt
        model_name: gpt-oss:20b

  # çµæœã‚’æ•´å½¢ã—ã¦å‡ºåŠ›
  result_formatter:
    agent: stringTemplateAgent
    inputs:
      result: :action.result
    console:
      before: result_formatter start
    params:
      template: |-
        ============================================================
        ğŸ‰ GraphAI ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆçµæœ
        ============================================================

        ${result}

        ============================================================
        âœ… ãƒ†ã‚¹ãƒˆå®Œäº†
        ============================================================

  # æœ€çµ‚å‡ºåŠ›
  output:
    agent: copyAgent
    console:
      before: output start
      after: true
    params:
      namedKey: text
    inputs:
      text: :result_formatter
    isResult: true
